<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ™ºèƒ½é€‰é¢˜ - V3 ç»Ÿä¸€é—¨æˆ·</title>
    <link rel="stylesheet" href="../css/v3-design-tokens.css">
    <link rel="stylesheet" href="../css/v3-unified.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        .score-s { background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%); border-left: 4px solid #f59e0b; }
        .score-a { background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%); border-left: 4px solid #3b82f6; }
        .score-b { background: linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%); border-left: 4px solid #10b981; }
        .score-c { background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%); border-left: 4px solid #f59e0b; }
        .score-d { background: linear-gradient(135deg, #fee2e2 0%, #fecaca 100%); border-left: 4px solid #ef4444; }
    </style>
</head>
<body class="bg-gray-50">
    <div id="app" class="min-h-screen">
        <!-- ç»Ÿä¸€å¯¼èˆªæ  -->
        <nav class="navbar bg-white shadow-md fixed top-0 left-0 right-0 z-50">
            <div class="navbar-brand px-4 flex items-center justify-between">
                <div class="flex items-center space-x-3">
                    <span class="text-2xl">ğŸ¯</span>
                    <span class="text-xl font-bold text-gray-900">æ™ºèƒ½é€‰é¢˜</span>
                </div>
                <button @click="toggleSidebar" class="md:hidden p-2 rounded hover:bg-gray-100">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
                    </svg>
                </button>
            </div>
            <div class="navbar-menu hidden md:flex px-4 space-x-4">
                <a v-for="module in modules" :key="module.id" :href="module.url"
                   class="px-3 py-2 rounded hover:bg-gray-100 transition-colors">
                    {{module.icon}} {{module.name}}
                </a>
            </div>
            <div class="navbar-actions px-4 flex items-center space-x-3">
                <button @click="toggleTheme" class="p-2 rounded hover:bg-gray-100">{{isDark ? 'â˜€ï¸' : 'ğŸŒ™'}}</button>
                <div class="user-menu flex items-center space-x-2">
                    <div class="w-8 h-8 bg-primary-500 rounded-full flex items-center justify-center text-white font-semibold">U</div>
                </div>
            </div>
        </nav>

        <!-- ä¾§è¾¹æ  -->
        <aside :class="['sidebar fixed left-0 top-16 bottom-0 w-64 bg-white shadow-lg transform transition-transform duration-300 z-40', isSidebarOpen ? 'translate-x-0' : '-translate-x-full md:translate-x-0']">
            <div class="sidebar-menu p-4 space-y-2">
                <a v-for="item in sidebarItems" :key="item.id" :href="item.url"
                   class="block px-4 py-2 rounded hover:bg-gray-100 transition-colors">
                    {{item.icon}} {{item.name}}
                </a>
            </div>
        </aside>

        <!-- ä¸»å†…å®¹åŒº -->
        <main class="main-content ml-0 md:ml-64 mt-16 p-6">
            <!-- é¢åŒ…å±‘å¯¼èˆª -->
            <div class="breadcrumb mb-4 flex items-center space-x-2 text-sm text-gray-600">
                <a href="v3_portal_v2.html" class="hover:text-primary-500">é¦–é¡µ</a>
                <span>/</span>
                <span class="text-gray-900 font-medium">æ™ºèƒ½é€‰é¢˜</span>
            </div>

            <!-- é¡µé¢å†…å®¹ -->
            <div class="page-content space-y-6">
                <!-- é…ç½®é¢æ¿ -->
                <div class="bg-white rounded-lg shadow p-6">
                    <h2 class="text-lg font-semibold mb-4">ğŸ“‹ ç”Ÿæˆé…ç½®</h2>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">ğŸ­ é€‰æ‹©è¡Œä¸š</label>
                            <div class="space-y-2">
                                <label v-for="ind in industries" :key="ind.id" class="flex items-center space-x-2 cursor-pointer">
                                    <input type="checkbox" v-model="selectedIndustries" :value="ind.id" class="rounded">
                                    <span class="text-sm">{{ind.name}}</span>
                                </label>
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">ğŸ“ åˆ‡å…¥è§’åº¦</label>
                            <div class="space-y-2">
                                <label v-for="angle in angles" :key="angle.id" class="flex items-center space-x-2 cursor-pointer">
                                    <input type="checkbox" v-model="selectedAngles" :value="angle.id" class="rounded">
                                    <span class="text-sm">{{angle.name}}</span>
                                </label>
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">âš™ï¸ ç”Ÿæˆè®¾ç½®</label>
                            <div class="space-y-3">
                                <div>
                                    <label class="text-xs text-gray-500">ç”Ÿæˆæ•°é‡</label>
                                    <select v-model="generateCount" class="w-full border rounded px-2 py-1 text-sm">
                                        <option value="10">10 ä¸ª</option>
                                        <option value="20" selected>20 ä¸ª</option>
                                        <option value="50">50 ä¸ª</option>
                                        <option value="100">100 ä¸ª</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="text-xs text-gray-500">æœ€ä½è¯„åˆ†</label>
                                    <select v-model="minScore" class="w-full border rounded px-2 py-1 text-sm">
                                        <option value="40">40 åˆ†+</option>
                                        <option value="60" selected>60 åˆ†+</option>
                                        <option value="75">75 åˆ†+</option>
                                        <option value="85">85 åˆ†+</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>
                    <button @click="generateTopics" :disabled="generating"
                            class="mt-4 w-full px-6 py-3 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:bg-gray-400">
                        {{generating ? 'ç”Ÿæˆä¸­...' : 'âœ¨ æ‰¹é‡ç”Ÿæˆ'}}
                    </button>
                </div>

                <!-- ç»Ÿè®¡å¡ç‰‡ -->
                <div class="grid grid-cols-1 md:grid-cols-5 gap-4">
                    <div class="bg-white rounded-lg shadow p-4">
                        <div class="text-sm text-gray-500">æ€»é€‰é¢˜æ•°</div>
                        <div class="text-2xl font-bold text-blue-600">{{topics.length}}</div>
                    </div>
                    <div class="bg-white rounded-lg shadow p-4">
                        <div class="text-sm text-gray-500">S çº§çˆ†æ¬¾</div>
                        <div class="text-2xl font-bold text-yellow-600">{{countByGrade('S')}}</div>
                    </div>
                    <div class="bg-white rounded-lg shadow p-4">
                        <div class="text-sm text-gray-500">A çº§ä¼˜è´¨</div>
                        <div class="text-2xl font-bold text-blue-600">{{countByGrade('A')}}</div>
                    </div>
                    <div class="bg-white rounded-lg shadow p-4">
                        <div class="text-sm text-gray-500">B çº§åˆæ ¼</div>
                        <div class="text-2xl font-bold text-green-600">{{countByGrade('B')}}</div>
                    </div>
                    <div class="bg-white rounded-lg shadow p-4">
                        <div class="text-sm text-gray-500">å¹³å‡åˆ†</div>
                        <div class="text-2xl font-bold text-purple-600">{{avgScore}}</div>
                    </div>
                </div>

                <!-- é€‰é¢˜åˆ—è¡¨ -->
                <div class="bg-white rounded-lg shadow">
                    <div class="px-4 py-3 border-b flex justify-between items-center">
                        <div>
                            <h2 class="text-lg font-semibold">é€‰é¢˜åˆ—è¡¨</h2>
                            <p class="text-sm text-gray-500">æ˜¾ç¤º {{filteredTopics.length}} / {{topics.length}} æ¡</p>
                        </div>
                        <div class="flex gap-2">
                            <button @click="sortBy('score')" class="px-3 py-1 rounded hover:bg-gray-100">ğŸ“Š æŒ‰è¯„åˆ†</button>
                            <button @click="sortBy('created_at')" class="px-3 py-1 rounded hover:bg-gray-100">ğŸ• æŒ‰æ—¶é—´</button>
                        </div>
                    </div>
                    <div v-if="generating" class="p-8 text-center">
                        <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"></div>
                        <p class="mt-2 text-gray-500">æ­£åœ¨ç”Ÿæˆé€‰é¢˜...</p>
                    </div>
                    <div v-else-if="filteredTopics.length === 0" class="p-8 text-center text-gray-500">
                        æš‚æ— é€‰é¢˜ï¼Œç‚¹å‡»"æ‰¹é‡ç”Ÿæˆ"æŒ‰é’®åˆ›å»ºæ–°é€‰é¢˜
                    </div>
                    <div v-else class="divide-y">
                        <div v-for="topic in filteredTopics" :key="topic.id"
                             class="p-4 hover:bg-gray-50 cursor-pointer" :class="'score-' + topic.score.grade.toLowerCase()"
                             @click="showDetail(topic)">
                            <div class="flex justify-between items-start">
                                <div class="flex-1">
                                    <div class="flex items-center gap-2 mb-1">
                                        <span class="text-xs px-2 py-0.5 rounded bg-blue-100">{{getIndustryName(topic.industry)}}</span>
                                        <span class="text-xs px-2 py-0.5 rounded bg-purple-100">{{getAngleName(topic.angle)}}</span>
                                    </div>
                                    <h3 class="text-lg font-semibold text-gray-900 mb-1">{{topic.title}}</h3>
                                    <p class="text-sm text-gray-600 line-clamp-2">{{topic.description}}</p>
                                </div>
                                <div class="text-right ml-4">
                                    <div class="text-2xl font-bold" :class="getScoreColor(topic.score.total)">{{topic.score.total}}</div>
                                    <div class="text-sm font-semibold">{{topic.score.grade}}çº§</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script src="../js/components-loader.js"></script>
    <script>
        const { createApp } = Vue;
        createApp({
            data() {
                return {
                    isDark: false,
                    isSidebarOpen: false,
                    generating: false,
                    topics: [],
                    filteredTopics: [],
                    selectedTopic: null,
                    sortDir: 'desc',
                    selectedIndustries: ['æ•™è‚²', 'ç§‘æŠ€'],
                    selectedAngles: ['æ·±åº¦åˆ†æ', 'æ•°æ®è§£è¯»'],
                    generateCount: '20',
                    minScore: '60',
                    modules: [
                        {id: 'hotnews', name: 'çƒ­ç‚¹ä¸­å¿ƒ', icon: 'ğŸ”¥', url: 'v3_hotnews_center_v2.html'},
                        {id: 'topics', name: 'æ™ºèƒ½é€‰é¢˜', icon: 'ğŸ¯', url: 'v3_topic_intelligence_v2.html'},
                        {id: 'evaluation', name: 'å·¥ä½œè¯„ä»·', icon: 'ğŸ“Š', url: 'v3_evaluation_v2.html'},
                        {id: 'publish', name: 'è‡ªåŠ¨å‘å¸ƒ', icon: 'ğŸ“', url: 'v3_publish_center_v2.html'},
                        {id: 'dashboard', name: 'æ•°æ®çœ‹æ¿', icon: 'ğŸ“ˆ', url: 'v3_data_dashboard_v2.html'}
                    ],
                    sidebarItems: [
                        {id: 'home', name: 'è¿”å›é¦–é¡µ', icon: 'ğŸ ', url: 'v3_portal_v2.html'},
                        {id: 'favorite', name: 'æˆ‘çš„æ”¶è—', icon: 'â­', url: '#'},
                        {id: 'recent', name: 'æœ€è¿‘è®¿é—®', icon: 'ğŸ•', url: '#'},
                        {id: 'settings', name: 'ç³»ç»Ÿè®¾ç½®', icon: 'âš™ï¸', url: 'v3_user_center_v2.html'}
                    ],
                    industries: [
                        {id: 'æ•™è‚²', name: 'ğŸ“ æ•™è‚²'}, {id: 'ç§‘æŠ€', name: 'ğŸ’» ç§‘æŠ€'},
                        {id: 'è´¢ç»', name: 'ğŸ’° è´¢ç»'}, {id: 'å¨±ä¹', name: 'ğŸ¬ å¨±ä¹'}
                    ],
                    angles: [
                        {id: 'æ·±åº¦åˆ†æ', name: 'ğŸ” æ·±åº¦åˆ†æ'}, {id: 'æ•°æ®è§£è¯»', name: 'ğŸ“Š æ•°æ®è§£è¯»'},
                        {id: 'è§‚ç‚¹è¯„è®º', name: 'ğŸ’¡ è§‚ç‚¹è¯„è®º'}, {id: 'çŸ¥è¯†ç§‘æ™®', name: 'ğŸ“ çŸ¥è¯†ç§‘æ™®'}
                    ]
                }
            },
            computed: {
                avgScore() {
                    if (this.topics.length === 0) return 0;
                    return Math.round(this.topics.reduce((a, b) => a + b.score.total, 0) / this.topics.length);
                }
            },
            methods: {
                toggleSidebar() { this.isSidebarOpen = !this.isSidebarOpen; },
                toggleTheme() {
                    this.isDark = !this.isDark;
                    document.documentElement.classList.toggle('dark', this.isDark);
                    localStorage.setItem('theme', this.isDark ? 'dark' : 'light');
                },
                generateTopics() {
                    this.generating = true;
                    setTimeout(() => {
                        this.topics = this.getMockTopics(20);
                        this.filteredTopics = this.topics;
                        this.generating = false;
                    }, 2000);
                },
                getMockTopics(count) {
                    return Array.from({length: count}, (_, i) => ({
                        id: `topic_${i}`,
                        title: `AI æ•™è‚²${['æœºé‡', 'æŒ‘æˆ˜', 'å˜é©', 'æœªæ¥'][i%4]}ï¼š${['æ·±åº¦åˆ†æ', 'æ•°æ®è§£è¯»'][i%2]}`,
                        industry: ['æ•™è‚²', 'ç§‘æŠ€', 'è´¢ç»'][i%3],
                        angle: ['æ·±åº¦åˆ†æ', 'æ•°æ®è§£è¯»', 'è§‚ç‚¹è¯„è®º'][i%3],
                        description: 'è¿™æ˜¯ä¸€ä¸ªå¾ˆæœ‰æ½œåŠ›çš„é€‰é¢˜ï¼Œå€¼å¾—æ·±å…¥æ¢è®¨...',
                        score: {
                            total: Math.floor(Math.random() * 40) + 60,
                            grade: ['S', 'A', 'B', 'C'][i%4]
                        },
                        created_at: new Date().toISOString()
                    }));
                },
                countByGrade(grade) { return this.topics.filter(t => t.score.grade === grade).length; },
                getIndustryName(id) { return this.industries.find(i => i.id === id)?.name || id; },
                getAngleName(id) { return this.angles.find(a => a.id === id)?.name || id; },
                getScoreColor(score) {
                    if (score >= 85) return 'text-yellow-600';
                    if (score >= 75) return 'text-blue-600';
                    if (score >= 60) return 'text-green-600';
                    return 'text-red-600';
                },
                sortBy(field) {
                    this.sortDir = this.sortDir === 'desc' ? 'asc' : 'desc';
                    this.filteredTopics.sort((a, b) => this.sortDir === 'desc' ? b.score.total - a.score.total : a.score.total - b.score.total);
                },
                showDetail(topic) { alert(`é€‰é¢˜è¯¦æƒ…ï¼š${topic.title}`); }
            },
            mounted() {
                loadComponents({title: 'æ™ºèƒ½é€‰é¢˜', breadcrumbs: ['é¦–é¡µ', 'æ™ºèƒ½é€‰é¢˜']});
            }
        }).mount('#app');
    </script>
</body>
</html>
