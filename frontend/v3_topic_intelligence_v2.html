<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>V3 æ™ºèƒ½é€‰é¢˜ - Topic Intelligence</title>
    <link rel="stylesheet" href="css/v3-design-tokens.css">
    <link rel="stylesheet" href="css/v3-unified.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <style>
        /* ==================== é¡µé¢ç‰¹å®šæ ·å¼ ==================== */
        
        /* é€‰é¢˜å¡ç‰‡ */
        .topic-card {
            transition: all var(--transition-base);
            cursor: pointer;
            border-left: 4px solid transparent;
            background: white;
        }
        .topic-card:hover {
            transform: translateX(4px);
            box-shadow: var(--shadow-lg);
        }
        .topic-card.s-grade { 
            border-left-color: #f59e0b; 
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%); 
        }
        .topic-card.a-grade { 
            border-left-color: #3b82f6; 
            background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%); 
        }
        .topic-card.b-grade { 
            border-left-color: #10b981; 
            background: linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%); 
        }
        .topic-card.c-grade { 
            border-left-color: #9ca3af; 
            background: linear-gradient(135deg, #f3f4f6 0%, #e5e7eb 100%); 
        }
        
        /* ç­‰çº§å¾½ç«  */
        .grade-badge {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 32px;
            height: 32px;
            border-radius: var(--radius-lg);
            font-weight: 700;
            font-size: 0.875rem;
            transition: all var(--transition-fast);
        }
        .grade-s { background: var(--warning-50); color: var(--warning-600); box-shadow: 0 2px 8px rgba(245, 158, 11, 0.2); }
        .grade-a { background: var(--primary-50); color: var(--primary-600); box-shadow: 0 2px 8px rgba(59, 130, 246, 0.2); }
        .grade-b { background: var(--success-50); color: var(--success-600); box-shadow: 0 2px 8px rgba(16, 185, 129, 0.2); }
        .grade-c { background: var(--gray-100); color: var(--gray-600); }
        
        /* æ–‡æœ¬æˆªæ–­ */
        .line-clamp-2 {
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        .line-clamp-3 {
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        
        /* åŠ è½½åŠ¨ç”» */
        .loading-spinner {
            width: 48px;
            height: 48px;
            border: 4px solid var(--gray-200);
            border-top-color: var(--primary-600);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }
        .loading-spinner-lg {
            width: 64px;
            height: 64px;
            border-width: 5px;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        /* å¼¹çª— */
        .modal-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(4px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: var(--z-index-modal);
            padding: var(--spacing-lg);
            animation: fadeIn 0.2s ease-out;
        }
        
        .modal-content {
            background: white;
            border-radius: var(--radius-xl);
            max-width: 900px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: var(--shadow-2xl);
            animation: slideUp 0.3s ease-out;
        }
        
        /* å¿«æ·é”®æç¤º */
        .shortcut-hint {
            position: fixed;
            bottom: var(--spacing-lg);
            right: var(--spacing-lg);
            background: var(--gray-900);
            color: white;
            padding: var(--spacing-sm) var(--spacing-md);
            border-radius: var(--radius-lg);
            font-size: 0.75rem;
            opacity: 0.8;
            z-index: var(--z-index-sticky);
            box-shadow: var(--shadow-lg);
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
        }
        
        .shortcut-key {
            display: inline-block;
            background: var(--gray-700);
            padding: 2px 6px;
            border-radius: var(--radius-sm);
            font-family: var(--font-family-mono);
            margin: 0 2px;
            border: 1px solid var(--gray-600);
        }
        
        /* ç­›é€‰å™¨æ ·å¼ */
        .filter-bar {
            display: flex;
            align-items: center;
            gap: var(--spacing-md);
            padding: var(--spacing-md) var(--spacing-lg);
            background: var(--gray-50);
            border-radius: var(--radius-lg);
            margin-bottom: var(--spacing-lg);
            flex-wrap: wrap;
        }
        
        .filter-input {
            flex: 1;
            min-width: 200px;
            padding: var(--spacing-sm) var(--spacing-md);
            border: 1px solid var(--gray-300);
            border-radius: var(--radius-md);
            font-size: 0.875rem;
            transition: all var(--transition-fast);
        }
        .filter-input:focus {
            outline: none;
            border-color: var(--primary-500);
            box-shadow: 0 0 0 3px var(--primary-100);
        }
        
        .filter-select {
            padding: var(--spacing-sm) var(--spacing-md);
            border: 1px solid var(--gray-300);
            border-radius: var(--radius-md);
            font-size: 0.875rem;
            background: white;
            cursor: pointer;
            transition: all var(--transition-fast);
        }
        .filter-select:focus {
            outline: none;
            border-color: var(--primary-500);
        }
        
        /* ç»Ÿè®¡å¡ç‰‡å¢å¼º */
        .v3-stat-card {
            position: relative;
            overflow: hidden;
        }
        .v3-stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 80px;
            height: 80px;
            background: radial-gradient(circle, rgba(59, 130, 246, 0.1) 0%, transparent 70%);
            border-radius: 0 0 0 100%;
        }
        
        /* é€šçŸ¥å¾½ç« åŠ¨ç”» */
        .v3-notification-badge {
            animation: pulse 2s infinite;
        }
        
        /* ç”¨æˆ·ä¸‹æ‹‰èœå• */
        .v3-user-dropdown {
            transition: all var(--transition-fast);
        }
        
        /* ä¾§è¾¹æ é¡¹å¾½ç«  */
        .sidebar-badge {
            position: absolute;
            top: 4px;
            right: 8px;
            background: var(--danger-500);
            color: white;
            font-size: 0.625rem;
            padding: 2px 5px;
            border-radius: var(--radius-full);
            min-width: 16px;
            text-align: center;
        }
        
        /* å“åº”å¼è°ƒæ•´ */
        @media (max-width: 768px) {
            .shortcut-hint {
                display: none;
            }
            .v3-stat-card::before {
                display: none;
            }
        }
        
        /* æš—è‰²æ¨¡å¼æ”¯æŒ */
        @media (prefers-color-scheme: dark) {
            .topic-card { background: var(--gray-800); }
            .modal-content { background: var(--gray-800); }
            .shortcut-hint { background: var(--gray-700); }
        }
        
        /* æ‰“å°æ ·å¼ */
        @media print {
            .v3-navbar,
            .v3-sidebar,
            .shortcut-hint,
            .v3-btn {
                display: none !important;
            }
            .topic-card {
                break-inside: avoid;
            }
        }
    </style>
</head>
<body>
    <div id="app" class="v3-layout">
        <!-- ç»Ÿä¸€å¯¼èˆªæ  -->
        <nav class="v3-navbar" role="navigation" aria-label="ä¸»å¯¼èˆªæ ">
            <a href="v3_portal.html" class="v3-navbar-brand">
                <span class="v3-navbar-brand-logo">ğŸ¯</span>
                <span class="v3-navbar-brand-label">æ™ºèƒ½é€‰é¢˜</span>
            </a>

            <div class="v3-navbar-nav">
                <a href="v3_portal.html" class="v3-navbar-link" data-module="portal">é—¨æˆ·</a>
                <a href="v3_coordinator.html" class="v3-navbar-link" data-module="coordinator">åè°ƒ</a>
                <a href="v3_workflow.html" class="v3-navbar-link" data-module="workflow">å·¥ä½œæµ</a>
                <a href="v3_publish_center.html" class="v3-navbar-link" data-module="publish">å‘å¸ƒ</a>
                <a href="v3_writing_factory.html" class="v3-navbar-link" data-module="writing">å†™ä½œ</a>
                <a href="v3_data_dashboard.html" class="v3-navbar-link" data-module="dashboard">æ•°æ®</a>
            </div>

            <div class="v3-navbar-actions">
                <div class="v3-navbar-notification" role="button" tabindex="0" aria-label="é€šçŸ¥ä¸­å¿ƒ" style="position: relative; cursor: pointer;">
                    <svg class="v3-navbar-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path>
                        <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
                    </svg>
                    <span class="v3-notification-badge" style="position: absolute; top: -4px; right: -4px; background: var(--danger-500); color: white; font-size: 0.625rem; padding: 2px 5px; border-radius: var(--radius-full); min-width: 16px; text-align: center;">3</span>
                </div>

                <button class="v3-navbar-theme-toggle" onclick="V3.Theme.toggle()" aria-label="åˆ‡æ¢ä¸»é¢˜" title="åˆ‡æ¢æ˜/æš—ä¸»é¢˜" style="background: none; border: none; cursor: pointer; padding: var(--spacing-sm); border-radius: var(--radius-md);">
                    <svg class="v3-theme-icon v3-theme-icon-light" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="5"></circle>
                        <path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"></path>
                    </svg>
                    <svg class="v3-theme-icon v3-theme-icon-dark" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="display: none;">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                </button>

                <div class="v3-navbar-user" role="button" tabindex="0" aria-haspopup="menu" aria-label="ç”¨æˆ·èœå•" style="position: relative;">
                    <div class="v3-navbar-user-avatar" id="navbar-user-avatar">A</div>
                    <div class="v3-navbar-user-info">
                        <span class="v3-navbar-user-name" id="navbar-user-name">Admin</span>
                        <span class="v3-navbar-user-role" id="navbar-user-role">ç®¡ç†å‘˜</span>
                    </div>
                    <svg class="v3-navbar-chevron" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="m6 9 6 6 6-6"></path>
                    </svg>

                    <div class="v3-user-dropdown" role="menu" style="position: absolute; top: 100%; right: 0; background: white; border: 1px solid var(--gray-200); border-radius: var(--radius-lg); box-shadow: var(--shadow-lg); min-width: 180px; display: none; z-index: var(--z-index-dropdown);">
                        <a href="/profile" class="v3-dropdown-item" role="menuitem" style="display: flex; align-items: center; gap: var(--spacing-sm); padding: var(--spacing-sm) var(--spacing-md); color: var(--gray-700); text-decoration: none;">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                                <circle cx="12" cy="7" r="4"></circle>
                            </svg>
                            ä¸ªäººä¸­å¿ƒ
                        </a>
                        <a href="/settings" class="v3-dropdown-item" role="menuitem" style="display: flex; align-items: center; gap: var(--spacing-sm); padding: var(--spacing-sm) var(--spacing-md); color: var(--gray-700); text-decoration: none;">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="12" r="3"></circle>
                                <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path>
                            </svg>
                            è®¾ç½®
                        </a>
                        <div class="v3-dropdown-divider" style="border-top: 1px solid var(--gray-200); margin: var(--spacing-xs) 0;"></div>
                        <button class="v3-dropdown-item v3-dropdown-logout" role="menuitem" onclick="V3.User.logout()" style="display: flex; align-items: center; gap: var(--spacing-sm); padding: var(--spacing-sm) var(--spacing-md); color: var(--danger-600); background: none; border: none; width: 100%; cursor: pointer;">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
                                <polyline points="16 17 21 12 16 7"></polyline>
                                <line x1="21" y1="12" x2="9" y2="12"></line>
                            </svg>
                            é€€å‡ºç™»å½•
                        </button>
                    </div>
                </div>

                <button class="v3-navbar-menu-toggle" aria-label="èœå•" aria-expanded="false" style="display: none; background: none; border: none; padding: var(--spacing-sm); cursor: pointer;">
                    <span class="v3-menu-bar" style="display: block; width: 20px; height: 2px; background: var(--gray-700); margin: 4px 0;"></span>
                    <span class="v3-menu-bar" style="display: block; width: 20px; height: 2px; background: var(--gray-700); margin: 4px 0;"></span>
                    <span class="v3-menu-bar" style="display: block; width: 20px; height: 2px; background: var(--gray-700); margin: 4px 0;"></span>
                </button>
            </div>
        </nav>

        <!-- ç»Ÿä¸€ä¾§è¾¹æ  -->
        <aside class="v3-sidebar" role="navigation" aria-label="ä¾§è¾¹å¯¼èˆª">
            <div class="v3-sidebar-content">
                <button class="v3-sidebar-collapse-btn" onclick="V3.Sidebar.toggle()" aria-label="æŠ˜å ä¾§è¾¹æ " title="æŠ˜å /å±•å¼€" style="background: none; border: none; cursor: pointer; padding: var(--spacing-sm); width: 100%; display: flex; justify-content: flex-end;">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="15 18 9 12 15 6"></polyline>
                    </svg>
                </button>

                <div class="v3-sidebar-section">
                    <h3 class="v3-sidebar-title">ä¸»èœå•</h3>
                    <nav class="v3-sidebar-menu">
                        <a href="v3_portal.html" class="v3-sidebar-item" data-module="portal">
                            <span class="v3-sidebar-item-icon">ğŸ </span>
                            <span class="v3-sidebar-item-label">é—¨æˆ·é¦–é¡µ</span>
                        </a>
                        <a href="v3_coordinator.html" class="v3-sidebar-item" data-module="coordinator">
                            <span class="v3-sidebar-item-icon">ğŸ¤–</span>
                            <span class="v3-sidebar-item-label">æ™ºèƒ½åè°ƒ</span>
                        </a>
                        <a href="v3_workflow.html" class="v3-sidebar-item" data-module="workflow">
                            <span class="v3-sidebar-item-icon">ğŸ”„</span>
                            <span class="v3-sidebar-item-label">å·¥ä½œæµ</span>
                        </a>
                        <a href="v3_publish_center.html" class="v3-sidebar-item" data-module="publish">
                            <span class="v3-sidebar-item-icon">ğŸ“¤</span>
                            <span class="v3-sidebar-item-label">å‘å¸ƒä¸­å¿ƒ</span>
                        </a>
                        <a href="v3_writing_factory.html" class="v3-sidebar-item" data-module="writing">
                            <span class="v3-sidebar-item-icon">âœï¸</span>
                            <span class="v3-sidebar-item-label">å†™ä½œå·¥å‚</span>
                        </a>
                        <a href="v3_data_dashboard.html" class="v3-sidebar-item" data-module="dashboard">
                            <span class="v3-sidebar-item-icon">ğŸ“Š</span>
                            <span class="v3-sidebar-item-label">æ•°æ®çœ‹æ¿</span>
                        </a>
                    </nav>
                </div>

                <div class="v3-sidebar-section">
                    <h3 class="v3-sidebar-title">æ™ºèƒ½é€‰é¢˜</h3>
                    <nav class="v3-sidebar-menu">
                        <a href="#" class="v3-sidebar-item active">
                            <span class="v3-sidebar-item-icon">ğŸ“‹</span>
                            <span class="v3-sidebar-item-label">é€‰é¢˜åˆ—è¡¨</span>
                        </a>
                        <a href="#" class="v3-sidebar-item">
                            <span class="v3-sidebar-item-icon">ğŸ“Š</span>
                            <span class="v3-sidebar-item-label">é€‰é¢˜åˆ†æ</span>
                        </a>
                        <a href="#" class="v3-sidebar-item">
                            <span class="v3-sidebar-item-icon">âœ¨</span>
                            <span class="v3-sidebar-item-label">æ™ºèƒ½ç”Ÿæˆ</span>
                        </a>
                    </nav>
                </div>

                <div class="v3-sidebar-section">
                    <div class="v3-sidebar-header" style="display: flex; justify-content: space-between; align-items: center;">
                        <h3 class="v3-sidebar-title">æœ€è¿‘è®¿é—®</h3>
                        <button class="v3-sidebar-clear-btn" onclick="V3.Sidebar.clearRecent()" aria-label="æ¸…ç©ºæœ€è¿‘è®¿é—®" style="background: none; border: none; color: var(--gray-500); font-size: 0.75rem; cursor: pointer;">æ¸…ç©º</button>
                    </div>
                    <nav class="v3-sidebar-menu" id="v3-sidebar-recent">
                    </nav>
                </div>

                <div class="v3-sidebar-section">
                    <h3 class="v3-sidebar-title">ç³»ç»ŸçŠ¶æ€</h3>
                    <div class="v3-sidebar-status">
                        <div class="v3-sidebar-status-item">
                            <span class="v3-sidebar-status-label">æœåŠ¡çŠ¶æ€</span>
                            <span class="v3-status-indicator">
                                <span class="v3-status-dot success"></span>
                                <span>è¿è¡Œä¸­</span>
                            </span>
                        </div>
                        <div class="v3-sidebar-status-item">
                            <span class="v3-sidebar-status-label">ä»Šæ—¥ä»»åŠ¡</span>
                            <span class="v3-sidebar-status-value" id="sidebar-task-count">12</span>
                        </div>
                    </div>
                </div>
            </div>
        </aside>

        <!-- ä¸»å†…å®¹åŒº -->
        <main class="v3-main">
            <div class="v3-content">
                <!-- ç»Ÿä¸€é¢åŒ…å±‘å¯¼èˆª -->
                <nav class="v3-breadcrumb" aria-label="é¢åŒ…å±‘å¯¼èˆª" style="display: flex; align-items: center; justify-content: space-between; margin-bottom: var(--spacing-lg); padding: var(--spacing-sm) 0; border-bottom: 1px solid var(--gray-200);">
                    <ol class="v3-breadcrumb-list" style="display: flex; align-items: center; gap: var(--spacing-sm); list-style: none; margin: 0; padding: 0;">
                        <li class="v3-breadcrumb-item" style="display: flex; align-items: center;">
                            <a href="v3_portal.html" class="v3-breadcrumb-link" style="color: var(--primary-600); text-decoration: none; display: flex; align-items: center; gap: 4px;">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                                    <polyline points="9 22 9 12 15 12 15 22"></polyline>
                                </svg>
                                <span>é¦–é¡µ</span>
                            </a>
                        </li>
                        <li class="v3-breadcrumb-item" style="color: var(--gray-400);">/</li>
                        <li class="v3-breadcrumb-item">
                            <span class="v3-breadcrumb-link" style="color: var(--gray-700); font-weight: 500;">æ™ºèƒ½é€‰é¢˜</span>
                        </li>
                    </ol>
                    <div class="v3-breadcrumb-actions" style="display: flex; gap: var(--spacing-sm);">
                        <button class="v3-breadcrumb-action-btn" onclick="window.location.reload()" aria-label="åˆ·æ–°" title="åˆ·æ–°" style="background: none; border: none; cursor: pointer; padding: var(--spacing-sm); border-radius: var(--radius-md); color: var(--gray-500);">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="23 4 23 10 17 10"></polyline>
                                <polyline points="1 20 1 14 7 14"></polyline>
                                <path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"></path>
                            </svg>
                        </button>
                        <button class="v3-breadcrumb-action-btn" onclick="sharePage()" aria-label="åˆ†äº«" title="åˆ†äº«å½“å‰é¡µ" style="background: none; border: none; cursor: pointer; padding: var(--spacing-sm); border-radius: var(--radius-md); color: var(--gray-500);">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="18" cy="5" r="3"></circle>
                                <circle cx="6" cy="12" r="3"></circle>
                                <circle cx="18" cy="19" r="3"></circle>
                                <line x1="8.59" y1="13.51" x2="15.42" y2="17.49"></line>
                                <line x1="15.41" y1="6.51" x2="8.59" y2="10.49"></line>
                            </svg>
                        </button>
                    </div>
                </nav>

                <!-- ç­›é€‰å·¥å…·æ  -->
                <div class="filter-bar">
                    <input type="text" v-model="searchQuery" placeholder="ğŸ” æœç´¢é€‰é¢˜æ ‡é¢˜æˆ–æè¿°..." class="filter-input" @input="filterTopics">
                    <select v-model="filterIndustry" class="filter-select" @change="filterTopics">
                        <option value="">å…¨éƒ¨è¡Œä¸š</option>
                        <option v-for="ind in industries" :value="ind.id">{{ ind.name }}</option>
                    </select>
                    <select v-model="filterGrade" class="filter-select" @change="filterTopics">
                        <option value="">å…¨éƒ¨ç­‰çº§</option>
                        <option value="S">S çº§çˆ†æ¬¾</option>
                        <option value="A">A çº§ä¼˜è´¨</option>
                        <option value="B">B çº§åˆæ ¼</option>
                        <option value="C">C çº§æ™®é€š</option>
                    </select>
                    <select v-model="filterAngle" class="filter-select" @change="filterTopics">
                        <option value="">å…¨éƒ¨è§’åº¦</option>
                        <option v-for="angle in angles" :value="angle.id">{{ angle.name }}</option>
                    </select>
                </div>

                <!-- ç»Ÿè®¡å¡ç‰‡ -->
                <div class="v3-grid v3-grid-5 v3-mb-lg" style="display: grid; grid-template-columns: repeat(5, 1fr); gap: var(--spacing-lg); margin-bottom: var(--spacing-lg);">
                    <div class="v3-stat-card">
                        <div class="v3-stat-label">æ€»é€‰é¢˜æ•°</div>
                        <div class="v3-stat-value" style="color: var(--primary-600);">{{ topics.length }}</div>
                    </div>
                    <div class="v3-stat-card">
                        <div class="v3-stat-label">S çº§çˆ†æ¬¾</div>
                        <div class="v3-stat-value" style="color: #f59e0b;">{{ countByGrade('S') }}</div>
                    </div>
                    <div class="v3-stat-card">
                        <div class="v3-stat-label">A çº§ä¼˜è´¨</div>
                        <div class="v3-stat-value" style="color: var(--primary-600);">{{ countByGrade('A') }}</div>
                    </div>
                    <div class="v3-stat-card">
                        <div class="v3-stat-label">B çº§åˆæ ¼</div>
                        <div class="v3-stat-value" style="color: var(--success-600);">{{ countByGrade('B') }}</div>
                    </div>
                    <div class="v3-stat-card">
                        <div class="v3-stat-label">å¹³å‡åˆ†</div>
                        <div class="v3-stat-value" style="color: var(--secondary-600);">{{ avgScore }}</div>
                    </div>
                </div>

                <!-- é€‰é¢˜åˆ—è¡¨ -->
                <div class="v3-card">
                    <div class="v3-card-header">
                        <div>
                            <h3 class="v3-card-title">é€‰é¢˜åˆ—è¡¨</h3>
                            <p class="v3-text-sm v3-text-gray">æ˜¾ç¤º {{ filteredTopics.length }} / {{ topics.length }} æ¡</p>
                        </div>
                        <div class="v3-flex v3-gap-sm">
                            <button @click="selectAll" class="v3-btn v3-btn-sm v3-btn-ghost" v-if="selectedTopics.length > 0">
                                å·²é€‰ {{ selectedTopics.length }} é¡¹
                            </button>
                            <button @click="sortBy('score')" class="v3-btn v3-btn-sm v3-btn-ghost">
                                ğŸ“Š æŒ‰è¯„åˆ† {{ sortDir==='desc'?'â†“':'â†‘' }}
                            </button>
                            <button @click="sortBy('created_at')" class="v3-btn v3-btn-sm v3-btn-ghost">
                                ğŸ• æŒ‰æ—¶é—´
                            </button>
                            <button @click="exportTopics" class="v3-btn v3-btn-sm v3-btn-ghost">
                                ğŸ“¥ å¯¼å‡º
                            </button>
                            <button @click="batchDelete" class="v3-btn v3-btn-sm v3-btn-danger" v-if="selectedTopics.length > 0">
                                ğŸ—‘ï¸ æ‰¹é‡åˆ é™¤
                            </button>
                            <button @click="generateTopics" class="v3-btn v3-btn-sm v3-btn-primary" :disabled="generating">
                                âœ¨ æ‰¹é‡ç”Ÿæˆ
                            </button>
                        </div>
                    </div>

                    <div v-if="generating" class="v3-card-body" style="text-align: center; padding: 40px;">
                        <div class="loading-spinner"></div>
                        <p class="v3-text-gray v3-mt-md">æ­£åœ¨ç”Ÿæˆé€‰é¢˜...</p>
                    </div>

                    <div v-else-if="filteredTopics.length === 0" class="v3-card-body" style="text-align: center; padding: 40px;">
                        <p class="v3-text-gray">æš‚æ— é€‰é¢˜ï¼Œç‚¹å‡»"æ‰¹é‡ç”Ÿæˆ"æŒ‰é’®åˆ›å»ºæ–°é€‰é¢˜</p>
                    </div>

                    <div v-else class="divide-y">
                        <div v-for="topic in filteredTopics" :key="topic.id" 
                             class="topic-card"
                             :class="getGradeClass(topic.score.grade)"
                             @click="showDetail(topic)"
                             style="position: relative;">
                            <input type="checkbox" 
                                   :checked="selectedTopics.includes(topic.id)"
                                   @click.stop="toggleSelect(topic.id)"
                                   style="position: absolute; top: var(--spacing-md); left: var(--spacing-md); z-index: 10;"
                                   title="é€‰æ‹©æ­¤é¡¹">
                            <div class="v3-flex v3-justify-between v3-items-start" style="padding: var(--spacing-md);">
                                <div class="flex-1">
                                    <div class="v3-flex v3-gap-sm v3-items-center v3-mb-sm">
                                        <span class="v3-badge v3-badge-info">{{ getIndustryName(topic.industry) }}</span>
                                        <span class="v3-badge v3-badge-secondary">{{ getAngleName(topic.angle) }}</span>
                                        <span class="v3-text-xs v3-text-gray">{{ formatTime(topic.created_at) }}</span>
                                        <span class="v3-badge v3-badge-gray" style="margin-left: auto;">#{{ topic.id }}</span>
                                    </div>
                                    <h3 class="v3-font-semibold v3-text-lg v3-mb-sm">{{ topic.title }}</h3>
                                    <p class="v3-text-sm v3-text-gray line-clamp-2">{{ topic.description }}</p>
                                </div>
                                <div class="text-right ml-4" style="text-align: right; margin-left: var(--spacing-md);">
                                    <div class="v3-text-2xl v3-font-bold" :class="getScoreColor(topic.score.total)">
                                        {{ topic.score.total }}
                                    </div>
                                    <div class="grade-badge" :class="getGradeBadgeClass(topic.score.grade)">
                                        {{ topic.score.grade }}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <!-- é€‰é¢˜è¯¦æƒ…å¼¹çª— -->
        <div v-if="selectedTopic" class="modal-overlay" @click.self="selectedTopic=null">
            <div class="modal-content">
                <div class="v3-card" style="max-width: 900px; width: 100%; border: none; box-shadow: none;">
                    <div class="v3-card-header">
                        <h3 class="v3-card-title">é€‰é¢˜è¯¦æƒ…</h3>
                        <button @click="selectedTopic=null" class="v3-btn v3-btn-ghost v3-btn-icon">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="v3-card-body">
                        <div class="v3-flex v3-justify-between v3-items-center v3-mb-md">
                            <div class="v3-flex v3-gap-sm">
                                <span class="v3-badge v3-badge-info">{{ getIndustryName(selectedTopic.industry) }}</span>
                                <span class="v3-badge v3-badge-secondary">{{ getAngleName(selectedTopic.angle) }}</span>
                            </div>
                            <div class="text-right" style="text-align: right;">
                                <div class="v3-text-3xl v3-font-bold" :class="getScoreColor(selectedTopic.score.total)">
                                    {{ selectedTopic.score.total }}
                                </div>
                                <div class="v3-text-sm v3-text-gray">{{ selectedTopic.score.grade }}çº§</div>
                            </div>
                        </div>

                        <h2 class="v3-text-xl v3-font-bold v3-mb-md">{{ selectedTopic.title }}</h2>
                        <p class="v3-text-gray v3-mb-md">{{ selectedTopic.description }}</p>

                        <div class="v3-mb-md">
                            <h4 class="v3-font-semibold v3-mb-sm">ğŸ”‘ æ ¸å¿ƒè¦ç‚¹</h4>
                            <ul class="v3-list-disc v3-pl-md" style="list-style: disc; padding-left: var(--spacing-md);">
                                <li v-for="(point, i) in selectedTopic.key_points" :key="i" class="v3-text-sm v3-text-gray" style="margin-bottom: var(--spacing-xs);">
                                    {{ point }}
                                </li>
                            </ul>
                        </div>

                        <div class="v3-mb-md" style="background: var(--gray-50); padding: var(--spacing-md); border-radius: var(--radius-lg);">
                            <h4 class="v3-font-semibold v3-mb-sm">ğŸ“Š è¯„åˆ†è¯¦æƒ…</h4>
                            <div class="v3-grid v3-grid-4" style="display: grid; grid-template-columns: repeat(4, 1fr); gap: var(--spacing-sm);">
                                <div style="text-align: center;">
                                    <div class="v3-text-sm v3-text-gray">æ–°é¢–æ€§</div>
                                    <div class="v3-font-bold" style="color: var(--primary-600);">{{ selectedTopic.score.novelty || 85 }}</div>
                                </div>
                                <div style="text-align: center;">
                                    <div class="v3-text-sm v3-text-gray">çƒ­åº¦</div>
                                    <div class="v3-font-bold" style="color: var(--warning-600);">{{ selectedTopic.score.trend || 78 }}</div>
                                </div>
                                <div style="text-align: center;">
                                    <div class="v3-text-sm v3-text-gray">å¯è¡Œæ€§</div>
                                    <div class="v3-font-bold" style="color: var(--success-600);">{{ selectedTopic.score.feasibility || 82 }}</div>
                                </div>
                                <div style="text-align: center;">
                                    <div class="v3-text-sm v3-text-gray">ä»·å€¼</div>
                                    <div class="v3-font-bold" style="color: var(--secondary-600);">{{ selectedTopic.score.value || 80 }}</div>
                                </div>
                            </div>
                        </div>

                        <div class="v3-mb-md">
                            <h4 class="v3-font-semibold v3-mb-sm">ğŸ“ æ“ä½œå†å²</h4>
                            <div style="font-size: 0.75rem; color: var(--gray-500);">
                                <div style="padding: var(--spacing-xs) 0; border-bottom: 1px solid var(--gray-200);">
                                    <span>åˆ›å»ºæ—¶é—´ï¼š</span>
                                    <span>{{ formatTime(selectedTopic.created_at) }}</span>
                                </div>
                                <div style="padding: var(--spacing-xs) 0;" v-if="selectedTopic.updated_at">
                                    <span>æœ€åæ›´æ–°ï¼š</span>
                                    <span>{{ formatTime(selectedTopic.updated_at) }}</span>
                                </div>
                            </div>
                        </div>

                        <div class="v3-flex v3-gap-md v3-mt-lg" style="display: flex; gap: var(--spacing-md); margin-top: var(--spacing-lg);">
                            <button @click="startWriting(selectedTopic)" class="v3-btn v3-btn-success" style="flex: 1;">
                                âœï¸ å¼€å§‹å†™ä½œ
                            </button>
                            <button @click="duplicateTopic(selectedTopic)" class="v3-btn v3-btn-secondary">
                                ğŸ“‹ å¤åˆ¶
                            </button>
                            <button @click="deleteTopic(selectedTopic)" class="v3-btn v3-btn-danger">
                                ğŸ—‘ï¸ åˆ é™¤
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- å¿«æ·é”®æç¤º -->
        <div class="shortcut-hint">
            <span class="shortcut-key">Alt+1~5</span> åˆ‡æ¢æ¨¡å—
            <span class="shortcut-key" style="margin-left: 8px;">Alt+S</span> ä¾§è¾¹æ 
            <span class="shortcut-key" style="margin-left: 8px;">Alt+H</span> é¦–é¡µ
            <span class="shortcut-key" style="margin-left: 8px;">Ctrl+F5</span> åˆ·æ–°
        </div>
    </div>

    <script src="js/v3-common.js"></script>
    <script src="js/v3-navigation-component.js"></script>
    <script>
        const { createApp } = Vue;

        createApp({
            data() {
                return {
                    API_BASE: 'http://43.134.234.4:8000/api/v3',
                    generating: false,
                    topics: [],
                    filteredTopics: [],
                    selectedTopic: null,
                    sortDir: 'desc',
                    searchQuery: '',
                    filterIndustry: '',
                    filterGrade: '',
                    filterAngle: '',
                    selectedTopics: [],
                    viewMode: 'list',
                    currentPage: 1,
                    pageSize: 20,
                    industries: [
                        { id: 'æ•™è‚²', name: 'ğŸ“ æ•™è‚²' },
                        { id: 'ç§‘æŠ€', name: 'ğŸ’» ç§‘æŠ€' },
                        { id: 'è´¢ç»', name: 'ğŸ’° è´¢ç»' },
                        { id: 'å¨±ä¹', name: 'ğŸ¬ å¨±ä¹' },
                        { id: 'ä½“è‚²', name: 'âš½ ä½“è‚²' },
                        { id: 'å¥åº·', name: 'ğŸ¥ å¥åº·' },
                        { id: 'èŒåœº', name: 'ğŸ’¼ èŒåœº' },
                        { id: 'ç”Ÿæ´»', name: 'ğŸ  ç”Ÿæ´»' }
                    ],
                    angles: [
                        { id: 'æ·±åº¦åˆ†æ', name: 'ğŸ” æ·±åº¦åˆ†æ' },
                        { id: 'æ•°æ®è§£è¯»', name: 'ğŸ“Š æ•°æ®è§£è¯»' },
                        { id: 'è§‚ç‚¹è¯„è®º', name: 'ğŸ’¡ è§‚ç‚¹è¯„è®º' },
                        { id: 'çŸ¥è¯†ç§‘æ™®', name: 'ğŸ“ çŸ¥è¯†ç§‘æ™®' }
                    ]
                }
            },
            computed: {
                avgScore() {
                    if (this.topics.length === 0) return 0;
                    const sum = this.topics.reduce((acc, t) => acc + t.score.total, 0);
                    return Math.round(sum / this.topics.length);
                }
            },
            mounted() {
                this.loadTopics();
                V3NavigationComponent.init('topic');
                this.initUserDropdown();
            },
            methods: {
                getGradeClass(grade) {
                    const classes = {
                        'S': 's-grade',
                        'A': 'a-grade',
                        'B': 'b-grade',
                        'C': 'c-grade'
                    };
                    return 'topic-card ' + (classes[grade] || 'c-grade');
                },
                getGradeBadgeClass(grade) {
                    const classes = {
                        'S': 'grade-s',
                        'A': 'grade-a',
                        'B': 'grade-b',
                        'C': 'grade-c'
                    };
                    return classes[grade] || 'grade-c';
                },
                getScoreColor(score) {
                    if (score >= 85) return 'v3-text-warning';
                    if (score >= 75) return 'v3-text-primary';
                    if (score >= 60) return 'v3-text-success';
                    return 'v3-text-danger';
                },
                async loadTopics() {
                    try {
                        const res = await fetch(`${this.API_BASE}/topics`);
                        const data = await res.json();
                        this.topics = data.data || [];
                        this.filteredTopics = this.topics;
                    } catch (e) {
                        this.topics = this.getMockTopics();
                        this.filteredTopics = this.topics;
                    }
                },
                async generateTopics() {
                    this.generating = true;
                    try {
                        const res = await fetch(`${this.API_BASE}/topics/generate`, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ count: 20 })
                        });
                        const data = await res.json();
                        this.topics = [...data.data, ...this.topics];
                        this.filteredTopics = this.topics;
                        V3.Notification.success(`ç”Ÿæˆ ${data.data.length} ä¸ªé€‰é¢˜`);
                    } catch (e) {
                        const mock = this.getMockTopics(20);
                        this.topics = [...mock, ...this.topics];
                        this.filteredTopics = this.topics;
                        V3.Notification.success('ç”Ÿæˆ 20 ä¸ªé€‰é¢˜ (Mock)');
                    } finally {
                        this.generating = false;
                    }
                },
                sortBy(field) {
                    this.sortDir = this.sortDir === 'desc' ? 'asc' : 'desc';
                    this.filteredTopics.sort((a, b) => {
                        const aVal = a[field] || a.score[field];
                        const bVal = b[field] || b.score[field];
                        return this.sortDir === 'desc' ? bVal - aVal : aVal - bVal;
                    });
                },
                showDetail(topic) {
                    this.selectedTopic = topic;
                },
                startWriting(topic) {
                    V3.Notification.success(`å¼€å§‹å†™ä½œï¼š${topic.title}`);
                    window.location.href = 'v3_writing_factory.html';
                },
                duplicateTopic(topic) {
                    const newTopic = {
                        ...topic,
                        id: `topic_${Date.now()}`,
                        title: topic.title + ' (å‰¯æœ¬)',
                        created_at: new Date().toISOString()
                    };
                    this.topics.unshift(newTopic);
                    this.filteredTopics.unshift(newTopic);
                    V3.Notification.success('é€‰é¢˜å·²å¤åˆ¶');
                },
                deleteTopic(topic) {
                    if (confirm(`ç¡®å®šåˆ é™¤é€‰é¢˜ï¼š${topic.title}?`)) {
                        this.topics = this.topics.filter(t => t.id !== topic.id);
                        this.filteredTopics = this.filteredTopics.filter(t => t.id !== topic.id);
                        this.selectedTopic = null;
                        V3.Notification.success('é€‰é¢˜å·²åˆ é™¤');
                    }
                },
                exportTopics() {
                    const data = JSON.stringify(this.topics, null, 2);
                    V3.Utils.downloadFile(data, `topics_${new Date().toISOString().split('T')[0]}.json`, 'application/json');
                    V3.Notification.success('é€‰é¢˜å·²å¯¼å‡º');
                },
                countByGrade(grade) {
                    return this.topics.filter(t => t.score.grade === grade).length;
                },
                getIndustryName(id) {
                    return this.industries.find(i => i.id === id)?.name || id;
                },
                getAngleName(id) {
                    return this.angles.find(a => a.id === id)?.name || id;
                },
                formatTime(timeStr) {
                    if (!timeStr) return '-';
                    const date = new Date(timeStr);
                    return date.toLocaleString('zh-CN', { month: '2-digit', day: '2-digit', hour: '2-digit', minute: '2-digit' });
                },
                toggleSelect(id) {
                    const index = this.selectedTopics.indexOf(id);
                    if (index > -1) {
                        this.selectedTopics.splice(index, 1);
                    } else {
                        this.selectedTopics.push(id);
                    }
                },
                selectAll() {
                    if (this.selectedTopics.length === this.filteredTopics.length) {
                        this.selectedTopics = [];
                    } else {
                        this.selectedTopics = this.filteredTopics.map(t => t.id);
                    }
                },
                batchDelete() {
                    if (this.selectedTopics.length === 0) return;
                    if (confirm(`ç¡®å®šåˆ é™¤é€‰ä¸­çš„ ${this.selectedTopics.length} ä¸ªé€‰é¢˜ï¼Ÿ`)) {
                        this.topics = this.topics.filter(t => !this.selectedTopics.includes(t.id));
                        this.filteredTopics = this.filteredTopics.filter(t => !this.selectedTopics.includes(t.id));
                        this.selectedTopics = [];
                        V3.Notification.success(`å·²åˆ é™¤ ${this.selectedTopics.length} ä¸ªé€‰é¢˜`);
                    }
                },
                filterTopics() {
                    let result = [...this.topics];
                    
                    // æœç´¢è¿‡æ»¤
                    if (this.searchQuery) {
                        const query = this.searchQuery.toLowerCase();
                        result = result.filter(t => 
                            t.title.toLowerCase().includes(query) ||
                            t.description.toLowerCase().includes(query)
                        );
                    }
                    
                    // è¡Œä¸šè¿‡æ»¤
                    if (this.filterIndustry) {
                        result = result.filter(t => t.industry === this.filterIndustry);
                    }
                    
                    // ç­‰çº§è¿‡æ»¤
                    if (this.filterGrade) {
                        result = result.filter(t => t.score.grade === this.filterGrade);
                    }
                    
                    // è§’åº¦è¿‡æ»¤
                    if (this.filterAngle) {
                        result = result.filter(t => t.angle === this.filterAngle);
                    }
                    
                    this.filteredTopics = result;
                },
                getMockTopics(count = 20) {
                    return Array.from({length: count}, (_, i) => ({
                        id: `topic_${i}`,
                        title: `AI æ•™è‚²${['æœºé‡','æŒ‘æˆ˜','å˜é©','æœªæ¥','è¶‹åŠ¿'][i%5]}ï¼š${['æ·±åº¦åˆ†æ','æ•°æ®è§£è¯»','è§‚ç‚¹è¯„è®º'][i%3]}`,
                        industry: ['æ•™è‚²', 'ç§‘æŠ€', 'è´¢ç»', 'èŒåœº'][i%4],
                        angle: ['æ·±åº¦åˆ†æ', 'æ•°æ®è§£è¯»', 'è§‚ç‚¹è¯„è®º', 'çŸ¥è¯†ç§‘æ™®'][i%4],
                        description: 'è¿™æ˜¯ä¸€ä¸ªå¾ˆæœ‰æ½œåŠ›çš„é€‰é¢˜ï¼Œå€¼å¾—æ·±å…¥æ¢è®¨...',
                        key_points: ['è¦ç‚¹ 1', 'è¦ç‚¹ 2', 'è¦ç‚¹ 3'],
                        score: {
                            total: Math.floor(Math.random() * 40) + 60,
                            grade: ['S', 'A', 'B', 'C'][i%4]
                        },
                        created_at: new Date().toISOString()
                    }));
                },
                initUserDropdown() {
                    const userMenu = document.querySelector('.v3-navbar-user');
                    const dropdown = document.querySelector('.v3-user-dropdown');
                    if (userMenu && dropdown) {
                        userMenu.addEventListener('click', (e) => {
                            e.stopPropagation();
                            dropdown.style.display = dropdown.style.display === 'block' ? 'none' : 'block';
                        });
                        document.addEventListener('click', () => {
                            dropdown.style.display = 'none';
                        });
                    }
                }
            }
        }).mount('#app');

        // å…¨å±€å¿«æ·é”®
        document.addEventListener('keydown', (e) => {
            if (e.altKey && e.key >= '1' && e.key <= '5') {
                const links = ['v3_portal.html', 'v3_coordinator.html', 'v3_workflow.html', 'v3_publish_center.html', 'v3_data_dashboard.html'];
                const index = parseInt(e.key) - 1;
                if (links[index]) window.location.href = links[index];
            }
            if (e.altKey && e.key === 's') {
                e.preventDefault();
                const sidebar = document.querySelector('.v3-sidebar');
                if (sidebar) sidebar.classList.toggle('collapsed');
            }
            if (e.altKey && e.key === 'h') {
                window.location.href = 'v3_portal.html';
            }
            if (e.ctrlKey && e.key === 'F5') {
                e.preventDefault();
                window.dispatchEvent(new CustomEvent('v3:refresh'));
            }
        });

        // åˆ†äº«åŠŸèƒ½
        function sharePage() {
            const url = window.location.href;
            if (navigator.share) {
                navigator.share({ title: 'æ™ºèƒ½é€‰é¢˜', url: url });
            } else {
                navigator.clipboard.writeText(url);
                V3.Notification.success('é“¾æ¥å·²å¤åˆ¶åˆ°å‰ªè´´æ¿');
            }
        }
    </script>
</body>
</html>
