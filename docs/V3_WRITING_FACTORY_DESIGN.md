# V3 写作工厂模块设计方案

> 创建时间：2026-03-02  
> 优先级：P0  
> 状态：开发中

---

## 📋 模块定位

**写作工厂**是 V3 架构的核心业务模块，负责：
- 文章大纲生成
- 初稿撰写
- 质量评估
- 优化改进
- 风格适配

---

## 🏗️ 架构设计

### 核心组件

```
writing_factory/
├── outliner.py           # 大纲生成器
├── draft_writer.py       # 初稿撰写器
├── style_adapter.py      # 风格适配器
├── quality_checker.py    # 质量检查器
├── optimizer.py          # 优化改进器
└── template_engine.py    # 模板引擎
```

### 写作流程

```
1. 接收选题
   ↓
2. 生成大纲 (3-5 个小节)
   ↓
3. 选择风格 (10+ 种)
   ↓
4. 撰写初稿
   ↓
5. 质量检查
   ↓
6. 优化改进
   ↓
7. 输出终稿
```

---

## ✍️ 写作风格库

### 预置风格 (10 种)

| 风格 | 特点 | 适用场景 |
|------|------|---------|
| 🎓 学术深度 | 严谨 + 引用 + 理论 | 教育/科技 |
| 📰 新闻报道 | 客观 + 事实 + 时效 | 新闻/热点 |
| 💼 商业分析 | 逻辑 + 数据 + 洞察 | 财经/职场 |
| 😄 幽默调侃 | 轻松 + 梗 + 吐槽 | 娱乐/生活 |
| 🌸 文艺抒情 | 感性 + 修辞 + 意境 | 文化/艺术 |
| 🔥 热血激励 | 激情 + 号召 + 行动 | 励志/成长 |
| 🤖 极客技术 | 专业 + 术语 + 实操 | 技术/编程 |
| 👩‍🏫 教育科普 | 易懂 + 案例 + 互动 | 教育/科普 |
| 💰 财经评论 | 犀利 + 洞察 + 预测 | 财经/投资 |
| 🎭 毒舌评论 | 尖锐 + 批判 + 反转 | 评论/观点 |

### 风格配置

```python
{
  "name": "学术深度",
  "tone": "严谨",
  "characteristics": ["引用权威", "理论支撑", "数据详实"],
  "prompt_template": "你是一位资深学者...",
  "word_count_range": [1500, 3000],
  "structure_preference": "总分总"
}
```

---

## 📐 大纲生成

### 结构模板 (5 种)

1. **总分总** - 经典结构
   - 开篇点题
   - 分论点 1/2/3
   - 总结升华

2. **问题 - 分析 - 解决** - 实用结构
   - 提出问题
   - 分析原因
   - 给出方案

3. **时间线** - 叙事结构
   - 过去
   - 现在
   - 未来

4. **对比式** - 辩证结构
   - 正面观点
   - 反面观点
   - 综合分析

5. **金字塔** - 结论先行
   - 核心结论
   - 支撑论据
   - 详细说明

### 大纲生成 Prompt

```
你是一位资深的内容策划专家。

基于以下选题生成文章大纲：

【选题标题】{title}
【选题描述】{description}
【核心要点】{key_points}
【选择风格】{style}
【目标字数】{word_count}

要求:
1. 生成 3-5 个小节
2. 每个小节包含：
   - 小节标题
   - 写作方向
   - 需要引用的事实
3. 符合选择的风格特点
4. 结构清晰，逻辑连贯

输出 JSON 格式
```

---

## 📝 初稿撰写

### 撰写策略

1. **分段撰写** - 按小节逐个生成
2. **事实注入** - 动态插入 Fact-Pack
3. **风格控制** - 通过 Prompt 约束
4. **长度控制** - 根据目标字数调整

### 撰写 Prompt

```
你是一位专业的内容创作者，擅长{style}风格写作。

【文章标题】{title}
【当前小节】{section_name}
【写作方向】{section_guidance}
【参考事实】{facts}
【字数要求】{word_count}

写作要求:
1. 符合{style}风格特点
2. 引用提供的事实
3. 语言流畅，逻辑清晰
4. 避免 AI 套话（如"综上所述"）
5. 适当使用修辞手法

开始撰写:
```

---

## 🔍 质量检查

### 检查维度

| 维度 | 权重 | 检查项 |
|------|------|--------|
| 内容质量 | 35% | 准确性/深度/数据支撑 |
| 结构逻辑 | 25% | 框架清晰/层次分明/过渡自然 |
| 表达文采 | 20% | 语言流畅/修辞运用/金句 |
| 传播价值 | 15% | 话题性/共鸣点/传播潜力 |
| 创新独特 | 5% | 视角新颖/差异化 |

### 检查清单

- [ ] 字数达标 (±10%)
- [ ] 无错别字
- [ ] 无语法错误
- [ ] 引用准确
- [ ] 数据可靠
- [ ] 逻辑连贯
- [ ] 风格一致
- [ ] 无 AI 套话
- [ ] 有金句亮点

---

## 🔄 优化改进

### 优化策略

1. **AI 痕迹清除** - 替换套话
2. **金句增强** - 添加传播点
3. **数据补充** - 增加说服力
4. **案例丰富** - 提升可读性
5. **开头优化** - 增强吸引力
6. **结尾升华** - 提升价值感

### 优化 Prompt

```
你是一位资深的内容主编。

请优化以下文章:

【原文】{draft}
【质量评分】{score}
【改进建议】{feedback}

优化要求:
1. 清除 AI 套话（如"综上所述"、"在这个信息爆炸的时代"）
2. 增加 2-3 个金句
3. 补充数据支撑
4. 优化开头吸引力
5. 升华结尾价值

输出优化后的完整文章
```

---

## 📊 API 设计

### 接口列表

```
POST /api/v3/writing/outline      # 生成大纲
POST /api/v3/writing/draft        # 撰写初稿
POST /api/v3/writing/optimize     # 优化改进
GET  /api/v3/writing/styles       # 获取风格列表
GET  /api/v3/writing/templates    # 获取结构模板
POST /api/v3/writing/quality      # 质量检查
```

### 请求示例

```python
# 生成大纲
POST /api/v3/writing/outline
{
  "topic_id": "topic_123",
  "style": "学术深度",
  "structure": "总分总",
  "word_count": 2000
}

# 撰写初稿
POST /api/v3/writing/draft
{
  "outline": {...},
  "style": "学术深度",
  "word_count": 2000
}

# 优化改进
POST /api/v3/writing/optimize
{
  "draft": "...",
  "feedback": ["增加数据", "清除套话"]
}
```

---

## 📁 文件结构

```
core/writing_factory/
├── __init__.py
├── outliner.py              # 大纲生成器 (8KB)
├── draft_writer.py          # 初稿撰写器 (12KB)
├── style_adapter.py         # 风格适配器 (6KB)
├── quality_checker.py       # 质量检查器 (10KB)
├── optimizer.py             # 优化改进器 (8KB)
└── templates/
    ├── styles.json          # 风格配置
    └── structures.json      # 结构模板

api/v3/
└── writing.py               # 写作 API (10KB)

frontend/
└── v3_writing_factory.html  # 写作工厂界面 (20KB)

tests/
└── test_writing_factory.py  # 测试用例 (15KB)
```

---

## 🎯 开发计划

### Day 1: 核心模块
- [ ] outliner.py - 大纲生成
- [ ] draft_writer.py - 初稿撰写
- [ ] style_adapter.py - 风格适配

### Day 2: 质量保障
- [ ] quality_checker.py - 质量检查
- [ ] optimizer.py - 优化改进
- [ ] 模板配置

### Day 3: API + 前端
- [ ] writing.py - API 路由
- [ ] v3_writing_factory.html - 前端界面
- [ ] test_writing_factory.py - 测试

---

## 📊 成功指标

| 指标 | 目标值 |
|------|--------|
| 大纲生成时间 | < 10 秒 |
| 初稿撰写时间 | < 60 秒 (2000 字) |
| 质量评分 | > 75 分 |
| AI 痕迹清除率 | > 90% |
| 用户满意度 | > 85% |

---

*下一步：开始实现核心模块*
